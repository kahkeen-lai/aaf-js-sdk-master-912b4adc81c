"use strict";var n,t={},i=i||function(f){var t={},i=t.lib={},e=i.Base={extend:function(t){u.prototype=this;var i=new u;return t&&i.mixIn(t),i.hasOwnProperty("init")||(i.init=function(){i.$super.init.apply(this,arguments)}),(i.init.prototype=i).$super=this,i},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);t.hasOwnProperty("toString")&&(this.toString=t.toString)}},p=i.WordArray=e.extend({init:function(t,i){t=this.words=t||[],this.sigBytes=null!=i?i:4*t.length},toString:function(t){return(t||n).stringify(this)},concat:function(t){var i=this.words,e=t.words,r=this.sigBytes,n=t.sigBytes;if(this.clamp(),r%4)for(var s=0;s<n;s++){var o=e[s>>>2]>>>24-s%4*8&255;i[r+s>>>2]|=o<<24-(r+s)%4*8}else for(s=0;s<n;s+=4)i[r+s>>>2]=e[s>>>2];return this.sigBytes+=n,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=f.ceil(i/4)}}),r=t.enc={},n=r.Hex={stringify:function(t){for(var i=t.words,e=t.sigBytes,r=[],n=0;n<e;n++){var s=i[n>>>2]>>>24-n%4*8&255;r.push((s>>>4).toString(16)),r.push((15&s).toString(16))}return r.join("")},parse:function(t){for(var i=t.length,e=[],r=0;r<i;r+=2)e[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new p.init(e,i/2)}},s=r.Latin1={stringify:function(t){for(var i=t.words,e=t.sigBytes,r=[],n=0;n<e;n++){var s=i[n>>>2]>>>24-n%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse:function(t){for(var i=t.length,e=[],r=0;r<i;r++)e[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new p.init(e,i)}},o=r.Utf8={stringify:function(t){try{return decodeURIComponent(escape(s.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return s.parse(unescape(encodeURIComponent(t)))}},a=i.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new p.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=o.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var i=this._data,e=i.words,r=i.sigBytes,n=this.blockSize,s=r/(4*n),o=(s=t?f.ceil(s):f.max((0|s)-this._minBufferSize,0))*n,a=f.min(4*o,r);if(o){for(var h=0;h<o;h+=n)this._doProcessBlock(e,h);var u=e.splice(0,o);i.sigBytes-=a}return new p.init(u,a)},_minBufferSize:0}),h=(i.Hasher=a.extend({cfg:e.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){a.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new h.HMAC.init(e,i).finalize(t)}}}),t.algo={});function u(){}return t}(Math);if(!function(n){var t=i,e=t.lib,r=e.WordArray,s=e.Hasher,o=t.algo,a=[],b=[];!function(){function t(t){return 4294967296*(t-(0|t))|0}for(var i=2,e=0;e<64;)!function(t){for(var i=n.sqrt(t),e=2;e<=i;e++)if(!(t%e))return;return 1}(i)||(e<8&&(a[e]=t(n.pow(i,.5))),b[e]=t(n.pow(i,1/3)),e++),i++}();var S=[],h=o.SHA256=s.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(t,i){for(var e,r,n,s,o=this._hash.words,a=o[0],h=o[1],u=o[2],f=o[3],p=o[4],l=o[5],c=o[6],g=o[7],d=0;d<64;d++){d<16?S[d]=0|t[i+d]:(r=((e=S[d-15])<<25|e>>>7)^(e<<14|e>>>18)^e>>>3,s=((n=S[d-2])<<15|n>>>17)^(n<<13|n>>>19)^n>>>10,S[d]=r+S[d-7]+s+S[d-16]);var v=a&h^a&u^h&u,y=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),m=g+((p<<26|p>>>6)^(p<<21|p>>>11)^(p<<7|p>>>25))+(p&l^~p&c)+b[d]+S[d],g=c,c=l,l=p,p=f+m|0,f=u,u=h,h=a,a=m+(y+v)|0}o[0]=o[0]+a|0,o[1]=o[1]+h|0,o[2]=o[2]+u|0,o[3]=o[3]+f|0,o[4]=o[4]+p|0,o[5]=o[5]+l|0,o[6]=o[6]+c|0,o[7]=o[7]+g|0},_doFinalize:function(){var t=this._data,i=t.words,e=8*this._nDataBytes,r=8*t.sigBytes;return i[r>>>5]|=128<<24-r%32,i[14+(64+r>>>9<<4)]=n.floor(e/4294967296),i[15+(64+r>>>9<<4)]=e,t.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var t=s.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA256=s._createHelper(h),t.HmacSHA256=s._createHmacHelper(h)}(Math),null==e){var s,e=new Array,r=0;if(void 0!==t&&void 0!==t.msCrypto){var o=t.msCrypto;if(o.getRandomValues){var a=new Uint8Array(32);for(o.getRandomValues(a),s=0;s<32;++s)e[r++]=a[s]}}for(;r<256;)s=Math.floor(65536*Math.random()),e[r++]=s>>>8,e[r++]=255&s;r=0,n=(new Date).getTime(),e[r++]^=255&n,e[r++]^=n>>8&255,e[r++]^=n>>16&255,e[r++]^=n>>24&255,256<=r&&(r-=256)}function h(t){for(var i,e,r="",n=0,s=0;s<t.length&&"="!=t.charAt(s);++s)(e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(s)))<0||(n=0==n?(r+=g(e>>2),i=3&e,1):1==n?(r+=g(i<<2|e>>4),i=15&e,2):2==n?(r+=g(i),r+=g(e>>2),i=3&e,3):(r+=g(i<<2|e>>4),r+=g(15&e),0));return 1==n&&(r+=g(i<<2)),r}function u(t,i,e){null!=t&&("number"==typeof t?this.fromNumber(t,i,e):null==i&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,i))}function f(){return new u(null)}u.prototype.am=function(t,i,e,r,n,s){for(;0<=--s;){var o=i*this[t++]+e[r]+n;n=Math.floor(o/67108864),e[r++]=67108863&o}return n},u.prototype.DB=26,u.prototype.DM=67108863,u.prototype.DV=1<<26,u.prototype.FV=Math.pow(2,52),u.prototype.F1=26,u.prototype.F2=0;for(var c=new Array,p="0".charCodeAt(0),l=0;l<=9;++l)c[p++]=l;for(p="a".charCodeAt(0),l=10;l<36;++l)c[p++]=l;for(p="A".charCodeAt(0),l=10;l<36;++l)c[p++]=l;function g(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function d(t,i){var e=c[t.charCodeAt(i)];return null==e?-1:e}function v(t){var i=f();return i.fromInt(t),i}function y(t){var i,e=1;return 0!=(i=t>>>16)&&(t=i,e+=16),0!=(i=t>>8)&&(t=i,e+=8),0!=(i=t>>4)&&(t=i,e+=4),0!=(i=t>>2)&&(t=i,e+=2),0!=(i=t>>1)&&(t=i,e+=1),e}function m(t){this.m=t}function b(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function S(t,i){return new u(t,i)}function w(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}m.prototype.convert=function(t){return t.s<0||0<=t.compareTo(this.m)?t.mod(this.m):t},m.prototype.revert=function(t){return t},m.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},m.prototype.mulTo=function(t,i,e){t.multiplyTo(i,e),this.reduce(e)},m.prototype.sqrTo=function(t,i){t.squareTo(i),this.reduce(i)},b.prototype.convert=function(t){var i=f();return t.abs().dlShiftTo(this.m.t,i),i.divRemTo(this.m,null,i),t.s<0&&0<i.compareTo(u.ZERO)&&this.m.subTo(i,i),i},b.prototype.revert=function(t){var i=f();return t.copyTo(i),this.reduce(i),i},b.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var i=0;i<this.m.t;++i){var e=32767&t[i],r=e*this.mpl+((e*this.mph+(t[i]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[e=i+this.m.t]+=this.m.am(0,r,t,i,0,this.m.t);t[e]>=t.DV;)t[e]-=t.DV,t[++e]++}t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)},b.prototype.mulTo=function(t,i,e){t.multiplyTo(i,e),this.reduce(e)},b.prototype.sqrTo=function(t,i){t.squareTo(i),this.reduce(i)},u.prototype.copyTo=function(t){for(var i=this.t-1;0<=i;--i)t[i]=this[i];t.t=this.t,t.s=this.s},u.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,0<t?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},u.prototype.fromString=function(t,i){var e;if(16==i)e=4;else if(8==i)e=3;else if(256==i)e=8;else if(2==i)e=1;else if(32==i)e=5;else{if(4!=i)return void this.fromRadix(t,i);e=2}this.t=0,this.s=0;for(var r=t.length,n=!1,s=0;0<=--r;){var o=8==e?255&t[r]:d(t,r);o<0?"-"==t.charAt(r)&&(n=!0):(n=!1,0==s?this[this.t++]=o:s+e>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,(s+=e)>=this.DB&&(s-=this.DB))}8==e&&0!=(128&t[0])&&(this.s=-1,0<s&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&u.ZERO.subTo(this,this)},u.prototype.clamp=function(){for(var t=this.s&this.DM;0<this.t&&this[this.t-1]==t;)--this.t},u.prototype.dlShiftTo=function(t,i){for(var e=this.t-1;0<=e;--e)i[e+t]=this[e];for(e=t-1;0<=e;--e)i[e]=0;i.t=this.t+t,i.s=this.s},u.prototype.drShiftTo=function(t,i){for(var e=t;e<this.t;++e)i[e-t]=this[e];i.t=Math.max(this.t-t,0),i.s=this.s},u.prototype.lShiftTo=function(t,i){for(var e=t%this.DB,r=this.DB-e,n=(1<<r)-1,s=Math.floor(t/this.DB),o=this.s<<e&this.DM,a=this.t-1;0<=a;--a)i[a+s+1]=this[a]>>r|o,o=(this[a]&n)<<e;for(a=s-1;0<=a;--a)i[a]=0;i[s]=o,i.t=this.t+s+1,i.s=this.s,i.clamp()},u.prototype.rShiftTo=function(t,i){i.s=this.s;var e=Math.floor(t/this.DB);if(e>=this.t)i.t=0;else{var r=t%this.DB,n=this.DB-r,s=(1<<r)-1;i[0]=this[e]>>r;for(var o=e+1;o<this.t;++o)i[o-e-1]|=(this[o]&s)<<n,i[o-e]=this[o]>>r;0<r&&(i[this.t-e-1]|=(this.s&s)<<n),i.t=this.t-e,i.clamp()}},u.prototype.subTo=function(t,i){for(var e=0,r=0,n=Math.min(t.t,this.t);e<n;)r+=this[e]-t[e],i[e++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;e<this.t;)r+=this[e],i[e++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e<t.t;)r-=t[e],i[e++]=r&this.DM,r>>=this.DB;r-=t.s}i.s=r<0?-1:0,r<-1?i[e++]=this.DV+r:0<r&&(i[e++]=r),i.t=e,i.clamp()},u.prototype.multiplyTo=function(t,i){var e=this.abs(),r=t.abs(),n=e.t;for(i.t=n+r.t;0<=--n;)i[n]=0;for(n=0;n<r.t;++n)i[n+e.t]=e.am(0,r[n],i,n,0,e.t);i.s=0,i.clamp(),this.s!=t.s&&u.ZERO.subTo(i,i)},u.prototype.squareTo=function(t){for(var i=this.abs(),e=t.t=2*i.t;0<=--e;)t[e]=0;for(e=0;e<i.t-1;++e){var r=i.am(e,i[e],t,2*e,0,1);(t[e+i.t]+=i.am(e+1,2*i[e],t,2*e+1,r,i.t-e-1))>=i.DV&&(t[e+i.t]-=i.DV,t[e+i.t+1]=1)}0<t.t&&(t[t.t-1]+=i.am(e,i[e],t,2*e,0,1)),t.s=0,t.clamp()},u.prototype.divRemTo=function(t,i,e){var r=t.abs();if(!(r.t<=0)){var n=this.abs();if(n.t<r.t)return null!=i&&i.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=f());var s=f(),o=this.s,a=t.s,h=this.DB-y(r[r.t-1]);0<h?(r.lShiftTo(h,s),n.lShiftTo(h,e)):(r.copyTo(s),n.copyTo(e));var p=s.t,l=s[p-1];if(0!=l){var c=l*(1<<this.F1)+(1<p?s[p-2]>>this.F2:0),g=this.FV/c,d=(1<<this.F1)/c,v=1<<this.F2,m=e.t,b=m-p,S=null==i?f():i;for(s.dlShiftTo(b,S),0<=e.compareTo(S)&&(e[e.t++]=1,e.subTo(S,e)),u.ONE.dlShiftTo(p,S),S.subTo(s,s);s.t<p;)s[s.t++]=0;for(;0<=--b;){var A=e[--m]==l?this.DM:Math.floor(e[m]*g+(e[m-1]+v)*d);if((e[m]+=s.am(0,A,e,b,0,p))<A)for(s.dlShiftTo(b,S),e.subTo(S,e);e[m]<--A;)e.subTo(S,e)}null!=i&&(e.drShiftTo(p,i),o!=a&&u.ZERO.subTo(i,i)),e.t=p,e.clamp(),0<h&&e.rShiftTo(h,e),o<0&&u.ZERO.subTo(e,e)}}},u.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var i=3&t;return 0<(i=(i=(i=(i=i*(2-(15&t)*i)&15)*(2-(255&t)*i)&255)*(2-((65535&t)*i&65535))&65535)*(2-t*i%this.DV)%this.DV)?this.DV-i:-i},u.prototype.isEven=function(){return 0==(0<this.t?1&this[0]:this.s)},u.prototype.exp=function(t,i){if(4294967295<t||t<1)return u.ONE;var e,r=f(),n=f(),s=i.convert(this),o=y(t)-1;for(s.copyTo(r);0<=--o;){i.sqrTo(r,n),0<(t&1<<o)?i.mulTo(n,s,r):(e=r,r=n,n=e)}return i.revert(r)},u.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return this.toRadix(t);i=2}var e,r=(1<<i)-1,n=!1,s="",o=this.t,a=this.DB-o*this.DB%i;if(0<o--)for(a<this.DB&&0<(e=this[o]>>a)&&(n=!0,s=g(e));0<=o;)a<i?(e=(this[o]&(1<<a)-1)<<i-a,e|=this[--o]>>(a+=this.DB-i)):(e=this[o]>>(a-=i)&r,a<=0&&(a+=this.DB,--o)),0<e&&(n=!0),n&&(s+=g(e));return n?s:"0"},u.prototype.negate=function(){var t=f();return u.ZERO.subTo(this,t),t},u.prototype.abs=function(){return this.s<0?this.negate():this},u.prototype.compareTo=function(t){var i=this.s-t.s;if(0!=i)return i;var e=this.t;if(0!=(i=e-t.t))return this.s<0?-i:i;for(;0<=--e;)if(0!=(i=this[e]-t[e]))return i;return 0},u.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+y(this[this.t-1]^this.s&this.DM)},u.prototype.mod=function(t){var i=f();return this.abs().divRemTo(t,null,i),this.s<0&&0<i.compareTo(u.ZERO)&&t.subTo(i,i),i},u.prototype.modPowInt=function(t,i){var e=new(t<256||i.isEven()?m:b)(i);return this.exp(t,e)},u.ZERO=v(0),u.ONE=v(1),u.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},w.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},w.prototype.setPublic=function(t,i){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof t)this.n=t,this.e=i;else{if(!(null!=t&&null!=i&&0<t.length&&0<i.length))throw"Invalid RSA public key";this.n=S(t,16),this.e=parseInt(i,16)}},w.prototype.type="RSA";var A,x,D=function(){var l=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),c=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),r={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function g(t,i,e){return i?r[i]:String.fromCharCode(parseInt(e,16))}var d=new String(""),v=Object.hasOwnProperty;return function(t,a){var i,e=t.match(l),r=e[0],n=!1;"{"===r?o={}:"["===r?o=[]:(o=[],n=!0);for(var s,h,o,u=[o],f=1-n,p=e.length;f<p;++f){switch((r=e[f]).charCodeAt(0)){default:(s=u[0])[i||s.length]=+r,i=void 0;break;case 34:if(-1!==(r=r.substring(1,r.length-1)).indexOf("\\")&&(r=r.replace(c,g)),s=u[0],!i){if(!(s instanceof Array)){i=r||d;break}i=s.length}s[i]=r,i=void 0;break;case 91:s=u[0],u.unshift(s[i||s.length]=[]),i=void 0;break;case 93:u.shift();break;case 102:(s=u[0])[i||s.length]=!1,i=void 0;break;case 110:(s=u[0])[i||s.length]=null,i=void 0;break;case 116:(s=u[0])[i||s.length]=!0,i=void 0;break;case 123:s=u[0],u.unshift(s[i||s.length]={}),i=void 0;break;case 125:u.shift()}}if(n){if(1!==u.length)throw new Error;o=o[0]}else if(u.length)throw new Error;return a&&(o=(h=function(t,i){var e=t[i];if(e&&"object"==typeof e){var r,n=null;for(var s in e){v.call(e,s)&&e!==t&&(void 0!==(r=h(e,s))?e[s]=r:(n=n||[]).push(s))}if(n)for(var o=n.length;0<=--o;)delete e[n[o]]}return a.call(t,i,e)})({"":o},"")),o}}(),N=new function(){};function T(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),(t=t.replace(/-/g,"+")).replace(/_/g,"/")}function E(t){return h(T(t))}function P(t,i){if(-1==t.indexOf("-----BEGIN "))throw"can't find PEM header: "+i;return h((t=void 0!==i?(t=t.replace(new RegExp("^[^]*-----BEGIN "+i+"-----"),"")).replace(new RegExp("-----END "+i+"-----[^]*$"),""):(t=t.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,"")).replace(/[^0-9A-Za-z\/+=]*/g,""))}N.getLblen=function(t,i){if("8"!=t.substr(i+2,1))return 1;var e=parseInt(t.substr(i+3,1));return 0==e?-1:0<e&&e<10?e+1:-2},N.getL=function(t,i){var e=N.getLblen(t,i);return e<1?"":t.substr(i+2,2*e)},N.getVblen=function(t,i){var e;return""==(e=N.getL(t,i))?-1:("8"===e.substr(0,1)?new u(e.substr(2),16):new u(e,16)).intValue()},N.getVidx=function(t,i){var e=N.getLblen(t,i);return e<0?e:i+2*(e+1)},N.getV=function(t,i){var e=N.getVidx(t,i),r=N.getVblen(t,i);return t.substr(e,2*r)},N.getTLV=function(t,i){return t.substr(i,2)+N.getL(t,i)+N.getV(t,i)},N.getNextSiblingIdx=function(t,i){return N.getVidx(t,i)+2*N.getVblen(t,i)},N.getChildIdx=function(t,i){var e=N,r=new Array,n=e.getVidx(t,i);"03"==t.substr(i,2)?r.push(n+2):r.push(n);for(var s=e.getVblen(t,i),o=n,a=0;;){var h=e.getNextSiblingIdx(t,o);if(null==h||2*s<=h-n)break;if(200<=a)break;r.push(h),o=h,a++}return r},N.getIdxbyList=function(t,i,e,r){var n,s,o=N;if(0!=e.length)return n=e.shift(),s=o.getChildIdx(t,i),o.getIdxbyList(t,s[n],e,r);if(void 0!==r&&t.substr(i,2)!==r)throw Error("checking tag doesn't match: "+t.substr(i,2)+"!="+r);return i},N.getTLVbyList=function(t,i,e,r){var n=N,s=n.getIdxbyList(t,i,e);if(void 0===s)throw"can't find nthList object";if(void 0!==r&&t.substr(s,2)!=r)throw"checking tag doesn't match: "+t.substr(s,2)+"!="+r;return n.getTLV(t,s)},N.getVbyList=function(t,i,e,r,n){var s,o,a=N;if(void 0===(s=a.getIdxbyList(t,i,e,r)))throw"can't find nthList object";return o=a.getV(t,s),!0===n&&(o=o.substr(2)),o},N.isASN1HEX=function(t){var i=N;if(t.length%2==1)return!1;var e=i.getVblen(t,0),r=t.substr(0,2),n=i.getL(t,0);return t.length-r.length-n.length==2*e},void 0!==A&&A||(A={}),void 0!==A.lang&&A.lang||(A.lang={}),A.lang.String=function(){},x="function"==typeof Buffer?function(t){return Buffer.from(T(t),"base64").toString("utf8")}:function(t){return decodeURIComponent(E(t).replace(/(..)/g,"%$1"))},void 0!==A&&A||(A={}),void 0!==A.crypto&&A.crypto||(A.crypto={}),A.crypto.Util=new function(){this.DIGESTINFOHEAD={sha256:"3031300d060960864801650304020105000420"},this.DEFAULTPROVIDER={sha256:"cryptojs",SHA256withRSA:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={sha256:i.algo.SHA256}},A.crypto.Util.SECURERANDOMGEN=new function(){},A.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(e,t){if(null!==(e=A.crypto.MessageDigest.getCanonicalAlgName(e))&&void 0===t&&(t=A.crypto.Util.DEFAULTPROVIDER[e]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)&&"cryptojs"==t){try{this.md=A.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=i.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){return this.md.finalize().toString(i.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=A.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},A.crypto.MessageDigest.getCanonicalAlgName=function(t){return"string"==typeof t&&(t=(t=t.toLowerCase()).replace(/-/,"")),t},A.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},A.crypto.Signature=function(t){var i;if(this._setAlgNames=function(){var t=this.algName.match(/^(.+)with(.+)$/);t&&(this.mdAlgName=t[1].toLowerCase(),this.pubkeyAlgName=t[2].toLowerCase())},this.setAlgAndProvider=function(t,i){if(this._setAlgNames(),"cryptojs/jsrsa"!=i)throw"provider not supported: "+i;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new A.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,i){var e=null;try{e=void 0===i?H.getKey(t):H.getKey(t,i)}catch(t){throw"init failed:"+t}if(!0===e.isPrivate)this.prvKey=e,this.state="SIGN";else{if(!0!==e.isPublic)throw"init failed.:"+e;this.pubKey=e,this.state="VERIFY"}},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.verify=function(t){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==A.crypto.ECDSA&&(this.pubKey=new A.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof w&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t)}}},this.init=function(t,i){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},void 0!==(this.initParams=t)&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=A.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{i=H.getKey(t.prvkeypem),this.init(i)}catch(t){throw"fatal error to load pem private key: "+t}}},A.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==A&&A||(A={}),void 0!==A.jws&&A.jws||(A.jws={}),A.jws.JWS=function(){A.jws.JWS.isSafeJSONString},A.jws.JWS.verify=function(t,i,e){var r=A.jws.JWS,n=r.readSafeJSONString,s=A.crypto,o=s.ECDSA,a=(s.Mac,s.Signature),h=w,u=t.split(".");if(3!==u.length)return!1;var f,p=u[0]+"."+u[1],l=E(u[2]),c=n(x(u[0])),g=null;if(void 0===c.alg)throw"algorithm not specified in header";if(f=(g=c.alg).substr(0,2),null!=e&&"[object Array]"===Object.prototype.toString.call(e)&&0<e.length&&-1==(":"+e.join(":")+":").indexOf(":"+g+":"))throw"algorithm '"+g+"' not accepted in the list";if("none"!=g&&null===i)throw"key shall be specified to verify.";if("string"==typeof i&&-1!=i.indexOf("-----BEGIN ")&&(i=H.getKey(i)),!("RS"!=f&&"PS"!=f||i instanceof h))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==f&&!(i instanceof o))throw"key shall be a ECDSA obj for ES* algs";var d;if(void 0===r.jwsalg2sigalg[c.alg])throw"unsupported alg name: "+g;if("none"==(d=r.jwsalg2sigalg[g]))throw"not supported";var v=new a({alg:d});return v.init(i),v.updateString(p),v.verify(l)},A.jws.JWS.parse=function(t){var i,e,r,n=t.split("."),s={};if(2!=n.length&&3!=n.length)throw"malformed sJWS: wrong number of '.' splitted elements";return i=n[0],e=n[1],3==n.length&&(r=n[2]),s.headerObj=A.jws.JWS.readSafeJSONString(x(i)),s.payloadObj=A.jws.JWS.readSafeJSONString(x(e)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),null==s.payloadObj?s.payloadPP=x(e):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==r&&(s.sigHex=E(r)),s},A.jws.JWS.verifyJWT=function(t,i,e){var r=A.jws,n=r.JWS,s=n.readSafeJSONString,o=n.inArray,a=n.includedArray,h=t.split("."),u=h[0],f=h[1],p=(E(h[2]),s(x(u))),l=s(x(f));if(void 0===p.alg)return!1;if(void 0===e.alg)throw"acceptField.alg shall be specified";if(!o(p.alg,e.alg))return!1;if(void 0!==l.iss&&"object"==typeof e.iss&&!o(l.iss,e.iss))return!1;if(void 0!==l.sub&&"object"==typeof e.sub&&!o(l.sub,e.sub))return!1;if(void 0!==l.aud&&"object"==typeof e.aud)if("string"==typeof l.aud){if(!o(l.aud,e.aud))return!1}else if("object"==typeof l.aud&&!a(l.aud,e.aud))return!1;var c=r.IntDate.getNow();return void 0!==e.verifyAt&&"number"==typeof e.verifyAt&&(c=e.verifyAt),void 0!==e.gracePeriod&&"number"==typeof e.gracePeriod||(e.gracePeriod=0),!(void 0!==l.exp&&"number"==typeof l.exp&&l.exp+e.gracePeriod<c||void 0!==l.nbf&&"number"==typeof l.nbf&&c<l.nbf-e.gracePeriod||void 0!==l.iat&&"number"==typeof l.iat&&c<l.iat-e.gracePeriod||void 0!==l.jti&&void 0!==e.jti&&l.jti!==e.jti||!n.verify(t,i,e.alg))},A.jws.JWS.inArray=function(t,i){if(null===i)return!1;if("object"!=typeof i)return!1;if("number"!=typeof i.length)return!1;for(var e=0;e<i.length;e++)if(i[e]==t)return!0;return!1},A.jws.JWS.jwsalg2sigalg={RS256:"SHA256withRSA"},A.jws.JWS.isSafeJSONString=function(t,i,e){var r;try{return"object"!=typeof(r=D(t))||r.constructor===Array?0:(i&&(i[e]=r),1)}catch(t){return 0}},A.jws.JWS.readSafeJSONString=function(t){var i;try{return"object"!=typeof(i=D(t))||i.constructor===Array?null:i}catch(t){return null}},A.jws.IntDate={},A.jws.IntDate.getZulu=function(t){return zulutosec(t)},A.jws.IntDate.getNow=function(){return~~(new Date/1e3)};var H={version:"1.0.0",_getKeyFromPublicPKCS8Hex:function(t){var i;if("2a864886f70d010101"!==N.getVbyList(t,0,[0,0],"06"))throw"unsupported PKCS#8 public key hex";return(i=new w).readPKCS8PubKeyHex(t),i},getKey:function(t,i,e){A.crypto;var r,n=H;if(void 0!==w&&t instanceof w)return t;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0===t.x)return(r=new _KJUR_crypto_DSA).setPublic(t.p,t.q,t.g,t.y),r;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0!==t.x)return(r=new _KJUR_crypto_DSA).setPrivate(t.p,t.q,t.g,t.y,t.x),r;if(-1==t.indexOf("-END PUBLIC KEY-"))throw"not supported argument";var s=P(t,"PUBLIC KEY");return n._getKeyFromPublicPKCS8Hex(s)}};w.prototype.readPKCS5PubKeyHex=function(t){var i=N,e=i.getV;if(!1===i.isASN1HEX(t))throw"keyHex is not ASN.1 hex string";var r=i.getChildIdx(t,0);if(2!==r.length||"02"!==t.substr(r[0],2)||"02"!==t.substr(r[1],2))throw"wrong hex for PKCS#5 public key";var n=e(t,r[0]),s=e(t,r[1]);this.setPublic(n,s)},w.prototype.readPKCS8PubKeyHex=function(t){var i=N;if(!1===i.isASN1HEX(t))throw"not ASN.1 hex string";if("06092a864886f70d010101"!==i.getTLVbyList(t,0,[0,0]))throw"not PKCS8 RSA public key";var e=i.getTLVbyList(t,0,[1,0]);this.readPKCS5PubKeyHex(e)},w.prototype.verifyWithMessageHash=function(t,i){if(i.length!=Math.ceil(this.n.bitLength()/4))return!1;var e=S(i,16);if(e.bitLength()>this.n.bitLength())return 0;var r=function(t){for(var i in A.crypto.Util.DIGESTINFOHEAD){var e=A.crypto.Util.DIGESTINFOHEAD[i],r=e.length;if(t.substring(0,r)==e)return[i,t.substring(r)]}return[]}(this.doPublic(e).toString(16).replace(/^1f+00/,""));return 0!=r.length&&(r[0],r[1]==t)},w.SALT_LEN_HLEN=-1,w.SALT_LEN_MAX=-2,w.SALT_LEN_RECOVER=-2,exports.b64utos=function(r){return function(t){for(var i="",e=0;e<t.length;e++)i+=String.fromCharCode(t[e]);return i}(function(){for(var t=h(T(r)),i=new Array,e=0;2*e<t.length;++e)i[e]=parseInt(t.substring(2*e,2*e+2),16);return i}())},exports.JWS=A.jws.JWS;
